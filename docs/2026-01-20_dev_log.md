# 开发日志 2026-01-20

## 核心更新
本日重点修复了项目构建与启动问题，优化了文档内嵌任务的实时同步机制，并对应用 Logo 和 UI 细节进行风格的现代化重构。同时对项目脚本进行了全面重构，适配 Supabase + Vercel 的新架构。

## 1. 缺陷修复 (Bug Fixes)

### 核心功能修复
- **实时同步失效修复**: 
  - **问题**: 在文档/笔记中添加 Markdown 任务后，主页任务列表无法立即刷新。
  - **原因**: `handleSaveNote` 函数在更新 `todos` 状态后，未触发 Markdown 解析逻辑。
  - **解决**: 在乐观更新（Optimistic Update）和服务器响应回调中，均显式调用 `updateDocTasks`，确保数据一致性。
- **空任务过滤**:
  - **问题**: 文档中的空白任务行（如 `- [ ] `）会被错误解析并显示在列表中。
  - **解决**: 优化 `markdownTasks.ts` 正则匹配逻辑，增加非空校验，自动忽略无文本内容的任务。

### 构建与启动修复
- **TypeScript 编译错误**: 修复了 `Dashboard.tsx` 中的变量提升（Hoisting）问题（`updateDocTasks` 定义前使用）；移除了 `TodoItem.tsx` 中未使用的变量。
- **环境权限**: 解决了构建过程中 `.env` 文件的读取权限问题。

## 2. UI/UX 改进 (Design & Experience)

### 品牌形象重构
- **全新 Logo**: 
  - **配色**: 采用与应用主题一致的淡雅靛青渐变（Soft Indigo, `#818CF8` → `#A78BFA`）。
  - **形态**: 采用 iOS 风格的超大圆角（Super-ellipse, `rx="104"`）。
  - **质感**: 添加顶部椭圆高光，营造细腻的玻璃质感，视觉更加轻量、现代。

### 交互细节
- **文档链接优化**: 
  - 将文档来源图标更换为 `ExternalLink`，更直观地传达"链接"概念。
  - 增加了 Hover 态交互：悬停时图标不透明度增加，文档标题显示下划线。

## 3. 项目脚本重构

项目已从本地 FastAPI 后端迁移到 Supabase 云服务，脚本进行了全面精简：

### 删除的文件
| 文件 | 原用途 | 删除原因 |
|------|--------|----------|
| `start_backend.sh` | 启动本地 Python 后端 | 已使用 Supabase |
| `setup_prod.sh` | 配置 Systemd 服务 | 已使用 Vercel 部署 |
| `api/index.py` | Vercel Serverless 入口 | 后端逻辑已迁移到 Supabase |
| `requirements.txt` | Python 依赖 | 不再需要本地后端 |

### 简化后的脚本
| 脚本 | 用途 | 使用场景 |
|------|------|----------|
| `setup_dev.sh` | 安装前端依赖 | 首次克隆或依赖更新后 |
| `start_app.sh` | 启动开发服务器 | 本地开发 |
| `deploy_app.sh` | 构建并部署到 Vercel | 发布新版本 |

### 配置文件更新
- **vercel.json**: 移除后端相关配置，简化为纯前端部署
- **README.md**: 重写文档，反映新的项目架构和工作流程

## 4. 代码优化
- 优化了 `parseMarkdownTasks` 函数的正则匹配效率。
- 统一了 `Dashboard` 组件中的状态更新逻辑，确保乐观更新与服务端数据的一致性。
